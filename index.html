<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>The Noori Styles - Product Categories</title>
  <style>
    :root {
      --theme-color: #f499c1;
      --theme-color-dark: #b35c85;
      --theme-color-light: #fff0f6;
      --theme-color-alt: #b3a2ce;
    }
    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: white;
      color: #4b3a57;
    }
    header {
      background: var(--theme-color);
      color: white;
      text-align: center;
      padding: 2rem 1rem;
      font-size: 2rem;
      font-weight: bold;
    }
    #themeChanger {
      max-width: 960px;
      margin: 1rem auto;
      padding: 0 1rem;
      text-align: center;
    }
    #themeInput {
      padding: 0.4rem 0.8rem;
      font-size: 1rem;
      border-radius: 6px;
      border: 1px solid #ccc;
      width: 120px;
      text-transform: lowercase;
      letter-spacing: 1px;
    }
    #applyThemeBtn {
      background: var(--theme-color-alt);
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 10px;
      font-weight: bold;
      cursor: pointer;
      margin-left: 0.5rem;
      transition: background-color 0.3s ease;
    }
    #applyThemeBtn:hover {
      background: var(--theme-color-dark);
    }
    main {
      max-width: 960px;
      margin: 2rem auto;
      padding: 0 1rem;
    }
    .section {
      margin-bottom: 3rem;
      border: 2px solid var(--theme-color);
      border-radius: 12px;
      background: var(--theme-color-light);
      padding: 1rem;
      position: relative;
    }
    .section-title {
      font-size: 1.5rem;
      font-weight: bold;
      color: var(--theme-color-dark);
      margin-bottom: 1rem;
      cursor: pointer;
    }
    .delete-section-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      background: #ff4d6d;
      border: none;
      color: white;
      padding: 6px 10px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.9rem;
    }
    .products {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1.2rem;
    }
    @media (min-width: 768px) {
      .products {
        grid-template-columns: repeat(4, 1fr);
      }
    }
    .product {
      background: var(--theme-color-alt);
      border-radius: 12px;
      padding: 1rem;
      box-shadow: 0 0 10px rgba(179, 162, 206, 0.4);
      color: white;
      text-align: center;
      position: relative;
    }
    .product img {
      max-width: 100%;
      border-radius: 12px;
      margin-bottom: 0.5rem;
    }
    .price {
      color: white;
      font-weight: bold;
      margin-top: 0.3rem;
    }
    .delete-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      background: #ff4d6d;
      border: none;
      color: white;
      padding: 4px 8px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.8rem;
    }
    form {
      margin: 1rem 0;
    }
    form input, form textarea {
      width: 100%;
      padding: 0.4rem;
      margin-bottom: 0.5rem;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 1rem;
    }
    form button {
      background: var(--theme-color);
      border: none;
      padding: 0.6rem 1.2rem;
      border-radius: 20px;
      color: white;
      font-weight: bold;
      cursor: pointer;
      width: 100%;
    }
    form button:hover {
      background: var(--theme-color-dark);
    }
    #addSectionBtn {
      display: block;
      margin: 2rem auto;
      background: var(--theme-color-alt);
      color: white;
      border: none;
      padding: 0.8rem 1.5rem;
      font-size: 1.1rem;
      border-radius: 10px;
      cursor: pointer;
    }
    footer {
      text-align: center;
      font-size: 0.9rem;
      margin-top: 3rem;
      padding-bottom: 1rem;
      color: #999;
    }
  </style>
</head>
<body>
  <header>The Noori Styles</header>

  <div id="themeChanger">
    <input id="themeInput" type="text" placeholder="#f499c1" maxlength="7" />
    <button id="applyThemeBtn">Apply Theme Color</button>
  </div>

  <main>
    <button id="addSectionBtn">+ Add New Section</button>
    <div id="sections"></div>
  </main>
  <footer>Â© 2025 The Noori Styles</footer>

  <script>
    let categories = JSON.parse(localStorage.getItem('categories') || '[]');

    // Load saved theme color or default
    const root = document.documentElement;
    const savedColor = localStorage.getItem('themeColor') || getComputedStyle(root).getPropertyValue('--theme-color').trim();
    setThemeColors(savedColor);
    document.getElementById('themeInput').value = savedColor;

    function saveCategories() {
      localStorage.setItem('categories', JSON.stringify(categories));
    }

    function createSection(categoryName = "Add a New Product") {
      const sectionId = Date.now();
      categories.push({ id: sectionId, name: categoryName, products: [] });
      saveCategories();
      renderSections();
    }

    function deleteSection(sectionId) {
      if (confirm('Delete this entire section?')) {
        categories = categories.filter(c => c.id !== sectionId);
        saveCategories();
        renderSections();
      }
    }

    function addProduct(categoryId, product) {
      const cat = categories.find(c => c.id === categoryId);
      if (cat) {
        cat.products.push(product);
        saveCategories();
        renderSections();
      }
    }

    function deleteProduct(categoryId, productId) {
      const cat = categories.find(c => c.id === categoryId);
      if (cat) {
        cat.products = cat.products.filter(p => p.id !== productId);
        saveCategories();
        renderSections();
      }
    }

    function renderSections() {
      const container = document.getElementById('sections');
      container.innerHTML = '';
      categories.forEach(category => {
        const section = document.createElement('div');
        section.className = 'section';

        const title = document.createElement('div');
        title.className = 'section-title';
        title.contentEditable = true;
        title.textContent = category.name;
        title.onblur = () => {
          category.name = title.textContent.trim() || 'Untitled Section';
          saveCategories();
        };

        const deleteBtn = document.createElement('button');
        deleteBtn.className = 'delete-section-btn';
        deleteBtn.textContent = 'Delete Section';
        deleteBtn.onclick = () => deleteSection(category.id);

        section.appendChild(title);
        section.appendChild(deleteBtn);

        // Form
        const form = document.createElement('form');
        form.innerHTML = `
          <input type="text" placeholder="Product Name" required />
          <input type="number" placeholder="Price" required min="0" step="0.01" />
          <input type="file" accept="image/*" required />
          <textarea placeholder="Description" required rows="2"></textarea>
          <button type="submit">Add Product</button>
        `;
        form.onsubmit = function(e) {
          e.preventDefault();
          const [nameInput, priceInput, fileInput, descInput] = form.querySelectorAll('input, textarea');
          const reader = new FileReader();
          reader.onload = () => {
            const product = {
              id: Date.now(),
              name: nameInput.value,
              price: priceInput.value,
              image: reader.result,
              description: descInput.value
            };
            addProduct(category.id, product);
            form.reset();
          };
          reader.readAsDataURL(fileInput.files[0]);
        };
        section.appendChild(form);

        // Products
        const productsDiv = document.createElement('div');
        productsDiv.className = 'products';
        category.products.forEach(product => {
          const div = document.createElement('div');
          div.className = 'product';
          div.innerHTML = `
            <img src="${product.image}" alt="${product.name}" />
            <h3>${product.name}</h3>
            <p>${product.description}</p>
            <div class="price">${product.price}</div>
          `;
          const deleteBtn = document.createElement('button');
          deleteBtn.textContent = 'Delete';
          deleteBtn.className = 'delete-btn';
          deleteBtn.onclick = () => deleteProduct(category.id, product.id);
          div.appendChild(deleteBtn);
          productsDiv.appendChild(div);
        });

        section.appendChild(productsDiv);
        container.appendChild(section);
      });
    }

    // Theme color change logic
    function setThemeColors(hexColor) {
      if(!/^#([0-9A-F]{3}){1,2}$/i.test(hexColor)) {
        alert("Invalid hex color code! Use format like #f499c1");
        return false;
      }
      root.style.setProperty('--theme-color', hexColor);
      // Darker variant for hover etc
      root.style.setProperty('--theme-color-dark', shadeColor(hexColor, -20));
      // Lighter variant for backgrounds
      root.style.setProperty('--theme-color-light', shadeColor(hexColor, 80));
      // Alternate purple-ish color (used for product bg) just shift hue a bit
      root.style.setProperty('--theme-color-alt', shadeColor(hexColor, 20));
      localStorage.setItem('themeColor', hexColor);
      return true;
    }

    // Utility: shade a hex color by % amount (- darker, + lighter)
    function shadeColor(color, percent) {
      let R = parseInt(color.substring(1,3),16);
      let G = parseInt(color.substring(3,5),16);
      let B = parseInt(color.substring(5,7),16);

      R = parseInt(R * (100 + percent) / 100);
      G = parseInt(G * (100 + percent) / 100);
      B = parseInt(B * (100 + percent) / 100);

      R = (R<255)?R:255;
      G = (G<255)?G:255;
      B = (B<255)?B:255;

      const RR = ((R.toString(16).length==1)?"0"+R.toString(16):R.toString(16));
      const GG = ((G.toString(16).length==1)?"0"+G.toString(16):G.toString(16));
      const BB = ((B.toString(16).length==1)?"0"+B.toString(16):B.toString(16));

      return "#"+RR+GG+BB;
    }

    document.getElementById('applyThemeBtn').onclick = () => {
      const val = document.getElementById('themeInput').value.trim();
      if(setThemeColors(val)) {
        alert("Theme color updated!");
      }
    };

    document.getElementById('addSectionBtn').onclick = () => {
      createSection();
    };

    window.onload = () => {
      renderSections();
    };
  </script>
</body>
</html>
