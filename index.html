function renderSections() {
  const container = document.getElementById('sections');
  container.innerHTML = '';
  categories.forEach(category => {
    const section = document.createElement('div');
    section.className = 'section';

    const title = document.createElement('div');
    title.className = 'section-title';
    title.contentEditable = true;
    title.textContent = category.name;
    title.onblur = () => {
      category.name = title.textContent.trim() || 'Untitled Section';
      saveCategories();
    };

    const deleteBtn = document.createElement('button');
    deleteBtn.className = 'delete-section-btn';
    deleteBtn.textContent = 'Delete Section';
    deleteBtn.onclick = () => deleteSection(category.id);

    section.appendChild(title);
    section.appendChild(deleteBtn);

    // Form
    const form = document.createElement('form');
    form.innerHTML = `
      <input type="text" placeholder="Product Name" required />
      <input type="number" placeholder="Price" required min="0" step="0.01" />
      <input type="file" accept="image/*" required />
      <textarea placeholder="Description" required rows="2"></textarea>
      <button type="submit">Add Product</button>
    `;
    form.onsubmit = function(e) {
      e.preventDefault();
      const [nameInput, priceInput, fileInput, descInput] = form.querySelectorAll('input, textarea');
      const reader = new FileReader();
      reader.onload = () => {
        const product = {
          id: Date.now(),
          name: nameInput.value,
          price: priceInput.value,
          image: reader.result,
          description: descInput.value
        };
        addProduct(category.id, product);
        form.reset();
      };
      reader.readAsDataURL(fileInput.files[0]);
    };
    section.appendChild(form);

    // Products
    const productsDiv = document.createElement('div');
    productsDiv.className = 'products';
    category.products.forEach(product => {
      const div = document.createElement('div');
      div.className = 'product';
      div.innerHTML = `
        <img src="${product.image}" alt="${product.name}" />
        <h3>${product.name}</h3>
        <p>${product.description}</p>
        <div class="price">${product.price}</div>
      `;

      // Delete button
      const deleteBtn = document.createElement('button');
      deleteBtn.textContent = 'Delete';
      deleteBtn.className = 'delete-btn';
      deleteBtn.onclick = () => deleteProduct(category.id, product.id);
      div.appendChild(deleteBtn);

      // âœ… Edit button
      const editBtn = document.createElement('button');
      editBtn.textContent = 'Edit';
      editBtn.className = 'delete-btn';
      editBtn.style.right = '60px'; // place left of delete button
      editBtn.onclick = () => {
        div.innerHTML = `
          <form class="edit-form">
            <input type="text" value="${product.name}" required />
            <input type="number" value="${product.price}" required min="0" step="0.01" />
            <input type="file" accept="image/*" />
            <textarea required rows="2">${product.description}</textarea>
            <button type="submit">Save</button>
            <button type="button" class="cancel-btn">Cancel</button>
          </form>
        `;
        const editForm = div.querySelector('.edit-form');
        const cancelBtn = editForm.querySelector('.cancel-btn');

        cancelBtn.onclick = () => renderSections();

        editForm.onsubmit = e => {
          e.preventDefault();
          const [nameInput, priceInput, fileInput, descInput] = editForm.querySelectorAll('input, textarea');
          const updateProduct = () => {
            product.name = nameInput.value;
            product.price = priceInput.value;
            product.description = descInput.value;
            saveCategories();
            renderSections();
          };

          if (fileInput.files.length > 0) {
            const reader = new FileReader();
            reader.onload = () => {
              product.image = reader.result;
              updateProduct();
            };
            reader.readAsDataURL(fileInput.files[0]);
          } else {
            updateProduct();
          }
        };
      };
      div.appendChild(editBtn);

      productsDiv.appendChild(div);
    });

    section.appendChild(productsDiv);
    container.appendChild(section);
  });
}
